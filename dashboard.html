<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard - SANTI FITNESS</title>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;600;800&display=swap" rel="stylesheet">
<script src="assets/js/auth.js"></script>
<script src="assets/js/dashboard.js"></script>
<style>
:root{--neon:#00ffc8; --gold:#d4af37; --purple:#c44dff; --pink:#ff6b9d; --cyan:#00d4ff; --danger:#ff3333;}
*{box-sizing:border-box; margin:0; padding:0;}
body{font-family:'Montserrat',sans-serif; background:linear-gradient(180deg, #000 0%, #0f2027 50%, #001a33 100%); color:white; min-height:100vh; padding:20px;}
@keyframes slideIn{from{transform:translateX(100%); opacity:0;} to{transform:translateX(0); opacity:1;}}
@keyframes slideOut{from{transform:translateX(0); opacity:1;} to{transform:translateX(100%); opacity:0;}}
@keyframes pulse{0%,100%{opacity:1;} 50%{opacity:0.5;}}
header{position:sticky; top:0; z-index:50; padding:20px 15px; background:linear-gradient(135deg, rgba(0, 0, 0, 0.8), rgba(10, 10, 20, 0.8)); box-shadow:0 0 50px rgba(0, 255, 200, 0.2); border-bottom:2px solid rgba(0, 255, 200, 0.1); display:flex; justify-content:space-between; align-items:center; border-radius:12px; margin-bottom:20px;}
header h1{font-size:28px; letter-spacing:2px; color:#00ffc8;}
.nav-btn{padding:10px 16px; border-radius:8px; border:1px solid var(--neon); background:rgba(0, 255, 200, 0.1); color:white; cursor:pointer; font-weight:600; font-size:12px; transition:all 0.3s;}
.nav-btn:hover{background:rgba(0, 255, 200, 0.2); transform:translateY(-2px); box-shadow:0 4px 12px rgba(0, 255, 200, 0.2);}
.container{max-width:1400px; margin:0 auto;}
.dashboard-grid{display:grid; grid-template-columns:repeat(auto-fit, minmax(300px, 1fr)); gap:20px; margin-bottom:30px;}
.stat-card{background:linear-gradient(135deg, rgba(20, 30, 40, 0.95), rgba(10, 10, 20, 0.95)); border-radius:12px; padding:20px; border:1px solid rgba(0, 255, 200, 0.2); box-shadow:0 8px 25px rgba(0, 255, 200, 0.1); transition:all 0.3s; cursor:pointer;}
.stat-card:hover{transform:translateY(-5px); box-shadow:0 12px 35px rgba(0, 255, 200, 0.2); border-color:rgba(0, 255, 200, 0.4);}
.stat-card h3{color:#00ffc8; font-size:14px; margin-bottom:10px; text-transform:uppercase; letter-spacing:1px;}
.stat-value{font-size:32px; font-weight:800; color:#00d4ff; margin:10px 0;}
.stat-label{font-size:12px; color:rgba(255, 255, 255, 0.6);}
.section{background:linear-gradient(135deg, rgba(20, 30, 40, 0.95), rgba(10, 10, 20, 0.95)); border-radius:12px; padding:25px; border:1px solid rgba(0, 255, 200, 0.2); margin-bottom:20px; box-shadow:0 8px 25px rgba(0, 255, 200, 0.1); transition:all 0.3s;}
.section-title{color:#00ffc8; font-size:22px; margin-bottom:20px; border-bottom:2px solid rgba(0, 255, 200, 0.2); padding-bottom:10px; display:flex; align-items:center; gap:10px;}
.workout-item{background:rgba(0, 255, 200, 0.05); padding:15px; border-radius:8px; margin-bottom:12px; border-left:3px solid #00ffc8; transition:all 0.3s;}
.workout-item:hover{background:rgba(0, 255, 200, 0.1); transform:translateX(5px);}
.workout-item.completed{border-left-color:#00ff00; background:rgba(0, 255, 0, 0.05);}
.workout-name{font-weight:600; color:#00ffc8; margin-bottom:5px;}
.workout-exercises{font-size:12px; color:rgba(255, 255, 255, 0.7); margin-bottom:8px;}
.exercise-list{display:flex; flex-wrap:wrap; gap:8px; margin-top:10px;}
.exercise-tag{background:rgba(0, 255, 200, 0.1); padding:4px 10px; border-radius:4px; font-size:11px; border:1px solid rgba(0, 255, 200, 0.2); transition:all 0.3s;}
.exercise-tag:hover{background:rgba(0, 255, 200, 0.2); border-color:rgba(0, 255, 200, 0.4);}
.achievement-grid{display:grid; grid-template-columns:repeat(auto-fill, minmax(120px, 1fr)); gap:15px; margin-top:15px;}
.achievement-badge{background:rgba(212, 175, 55, 0.15); padding:15px; border-radius:10px; text-align:center; border:2px solid rgba(212, 175, 55, 0.3); cursor:pointer; transition:all 0.3s; position:relative;}
.achievement-badge:hover{background:rgba(212, 175, 55, 0.25); transform:scale(1.05); box-shadow:0 8px 20px rgba(212, 175, 55, 0.3);}
.achievement-icon{font-size:32px; margin-bottom:8px;}
.achievement-name{font-size:11px; color:#d4af37; font-weight:600;}
.weight-chart{margin-top:20px;}
.chart-simple{display:flex; align-items:flex-end; height:150px; gap:8px; margin:20px 0;}
.chart-bar{flex:1; background:linear-gradient(180deg, #00ffc8, #00d4ff); border-radius:6px 6px 0 0; min-height:20px; position:relative; cursor:pointer; transition:all 0.3s;}
.chart-bar:hover{background:linear-gradient(180deg, #00ff00, #00d4ff);}
.button-group{display:flex; gap:10px; flex-wrap:wrap; margin-top:15px;}
button.btn{padding:10px 20px; background:linear-gradient(135deg, #00ffc8, #00d4ff); border:none; border-radius:8px; color:black; font-weight:600; cursor:pointer; font-size:13px; transition:all 0.3s;}
button.btn:hover{transform:translateY(-2px); box-shadow:0 8px 20px rgba(0, 255, 200, 0.4);}
button.btn.secondary{background:rgba(0, 255, 200, 0.1); color:#00ffc8; border:1px solid #00ffc8;}
button.btn.secondary:hover{background:rgba(0, 255, 200, 0.2);}
.modal{display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0, 0, 0, 0.9); justify-content:center; align-items:center; z-index:1000; backdrop-filter:blur(5px); animation:fadeIn 0.3s ease;}
.modal.active{display:flex;}
@keyframes fadeIn{from{opacity:0;} to{opacity:1;}}
.modal-content{background:linear-gradient(135deg, rgba(20, 30, 40, 0.98), rgba(10, 10, 20, 0.98)); padding:30px; border-radius:12px; max-width:500px; width:90%; border:1px solid rgba(0, 255, 200, 0.2); position:relative; animation:slideDown 0.3s ease;}
@keyframes slideDown{from{transform:translateY(-50px); opacity:0;} to{transform:translateY(0); opacity:1;}}
.modal-title{color:#00ffc8; font-size:20px; margin-bottom:20px;}
.modal-close{position:absolute; top:15px; right:15px; background:#ff3333; color:white; border:none; width:35px; height:35px; border-radius:50%; cursor:pointer; font-size:20px; transition:all 0.3s;}
.modal-close:hover{background:#ff5555; transform:rotate(90deg);}
.form-group{margin-bottom:15px;}
.form-group label{display:block; color:#00ffc8; font-weight:600; margin-bottom:8px; font-size:13px;}
.form-group input, .form-group textarea, .form-group select{width:100%; padding:10px; background:rgba(10, 10, 20, 0.8); border:1px solid rgba(0, 255, 200, 0.2); border-radius:6px; color:white; font-family:inherit; font-size:13px; transition:all 0.3s;}
.form-group input:focus, .form-group textarea:focus, .form-group select:focus{outline:none; border-color:var(--neon); box-shadow:0 0 15px rgba(0, 255, 200, 0.3);}
.form-group textarea{resize:vertical; min-height:100px;}
.note-item{background:rgba(0, 255, 200, 0.08); padding:12px; border-radius:6px; margin-bottom:10px; border-left:3px solid #00d4ff; display:flex; justify-content:space-between; align-items:start; transition:all 0.3s;}
.note-item:hover{background:rgba(0, 255, 200, 0.15); transform:translateX(3px);}
.note-info{flex:1;}
.note-title{font-weight:600; color:#00ffc8; margin-bottom:4px;}
.note-content{font-size:12px; color:rgba(255, 255, 255, 0.7); margin-bottom:4px; line-height:1.4;}
.note-date{font-size:11px; color:rgba(255, 255, 255, 0.5);}
.note-type{display:inline-block; background:rgba(0, 255, 200, 0.1); padding:2px 8px; border-radius:3px; font-size:11px; margin-top:4px; color:#00d4ff; border:1px solid rgba(0, 255, 200, 0.2);}
.achievement-card{background:rgba(212,175,55,0.1); border:2px solid rgba(212,175,55,0.3); border-radius:10px; padding:20px; margin-bottom:15px; transition:all 0.3s;}
.achievement-card:hover{background:rgba(212,175,55,0.2); border-color:rgba(212,175,55,0.5); transform:translateY(-3px);}
@media(max-width:768px){.dashboard-grid{grid-template-columns:1fr;} .section{padding:15px;} header{flex-direction:column; gap:10px;} header h1{font-size:22px;} .modal-content{width:95%;} .achievement-grid{grid-template-columns:repeat(auto-fill, minmax(80px, 1fr));}}
</style>
</head>
<body>

<header>
  <h1>üìä DASHBOARD</h1>
  <div>
    <button class="nav-btn" onclick="toggleTheme()">üåì Tema</button>
    <button class="nav-btn" onclick="openDataExportModal()">üíæ Datos</button>
    <button class="nav-btn" onclick="location.href='index.html'">üè† Inicio</button>
  </div>
</header>

<div class="container">
  <!-- Stats Principales -->
  <div class="dashboard-grid" id="statsGrid"></div>

  <!-- NUEVAS CARACTER√çSTICAS -->
  <!-- 1. Motivaci√≥n Diaria -->
  <div class="section" style="background: linear-gradient(135deg, rgba(196, 77, 255, 0.08), rgba(0, 212, 255, 0.08)); border: 1px solid rgba(196, 77, 255, 0.2);">
    <div id="motivationDiv"></div>
  </div>

  <!-- 2. Racha de Entrenamiento y Calculadora IMC -->
  <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
    <div id="streakDiv"></div>
    <div id="imcDiv"></div>
  </div>

  <!-- √öltimos Entrenamientos -->
  <div class="section">
    <div class="section-title">üèãÔ∏è √öltimos Entrenamientos</div>
    <div id="recentWorkouts">
      <p style="color:rgba(255,255,255,0.6); font-size:14px;">Carga tus entrenamientos desde ejercicios.html</p>
    </div>
    <button class="btn" onclick="location.href='ejercicios.html'" style="margin-top:15px;">Registrar Entrenamiento</button>
  </div>

  <!-- Registros de Peso -->
  <div class="section">
    <div class="section-title">‚öñÔ∏è Registros de Peso</div>
    <button class="btn secondary" onclick="openWeightModal()">+ Agregar Peso</button>
    <div id="weightRecordsDiv" style="margin-top:20px;"></div>
  </div>

  <!-- Ejercicios M√°s Trabajados -->
  <div class="section">
    <div class="section-title">üî• Top Ejercicios</div>
    <div id="topExercises" style="font-size:14px;"></div>
  </div>

  <!-- Logros -->
  <div class="section">
    <div class="section-title">üèÜ Logros Desbloqueados</div>
    <div class="achievement-grid" id="achievementsGrid"></div>
  </div>

  <!-- Notas -->
  <div class="section">
    <div class="section-title">üìù Mis Notas</div>
    <button class="btn secondary" onclick="openNoteModal()">+ Agregar Nota</button>
    <div id="notesDiv" style="margin-top:20px;"></div>
  </div>

  <!-- Modal: Editar Nota -->
  <div id="editNoteModal" class="modal">
    <div class="modal-content">
      <button class="modal-close" onclick="closeModal('editNoteModal')">‚úï</button>
      <div class="modal-title">‚úèÔ∏è Editar Nota</div>
      <div class="form-group">
        <label>T√≠tulo</label>
        <input type="text" id="editNoteTitle" placeholder="Ej: Entrenamiento de hoy">
      </div>
      <div class="form-group">
        <label>Contenido</label>
        <textarea id="editNoteContent" placeholder="Escribe tu nota..."></textarea>
      </div>
      <div class="form-group">
        <label>Tipo</label>
        <select id="editNoteType">
          <option value="general">General</option>
          <option value="workout">Entrenamiento</option>
          <option value="nutrition">Nutrici√≥n</option>
          <option value="progress">Progreso</option>
        </select>
      </div>
      <button class="btn" style="width:100%;" onclick="updateNoteFromModal()">üíæ Actualizar Nota</button>
    </div>
  </div>

  <!-- Recordatorios -->
  <div class="section">
    <div class="section-title">üîî Recordatorios</div>
    <button class="btn secondary" onclick="openReminderModal()">+ Agregar Recordatorio</button>
    <div id="remindersDiv" style="margin-top:20px;"></div>
  </div>
</div>

<!-- Modal: Agregar Peso -->
<div id="weightModal" class="modal">
  <div class="modal-content">
    <button class="modal-close" onclick="closeModal('weightModal')">‚úï</button>
    <div class="modal-title">‚öñÔ∏è Registrar Peso</div>
    <div class="form-group">
      <label>Peso (kg)</label>
      <input type="number" id="weightInput" placeholder="Ej: 75.5" step="0.1" min="0">
    </div>
    <div class="form-group">
      <label>Notas</label>
      <textarea id="weightNotesInput" placeholder="C√≥mo te sentiste, observaciones..."></textarea>
    </div>
    <button class="btn" style="width:100%;" onclick="saveWeight()">Guardar Peso</button>
  </div>
</div>

<!-- Modal: Agregar Nota -->
<div id="noteModal" class="modal">
  <div class="modal-content">
    <button class="modal-close" onclick="closeModal('noteModal')">‚úï</button>
    <div class="modal-title">üìù Agregar Nota</div>
    <div class="form-group">
      <label>T√≠tulo</label>
      <input type="text" id="noteTitle" placeholder="Ej: Entrenamiento de hoy">
    </div>
    <div class="form-group">
      <label>Contenido</label>
      <textarea id="noteContent" placeholder="Escribe tu nota..."></textarea>
    </div>
    <div class="form-group">
      <label>Tipo</label>
      <select id="noteType">
        <option value="general">General</option>
        <option value="workout">Entrenamiento</option>
        <option value="nutrition">Nutrici√≥n</option>
        <option value="progress">Progreso</option>
      </select>
    </div>
    <button class="btn" style="width:100%;" onclick="saveNote()">Guardar Nota</button>
  </div>
</div>

<!-- Modal: Agregar Recordatorio -->
<div id="reminderModal" class="modal">
  <div class="modal-content">
    <button class="modal-close" onclick="closeModal('reminderModal')">‚úï</button>
    <div class="modal-title">üîî Agregar Recordatorio</div>
    <div class="form-group">
      <label>T√≠tulo</label>
      <input type="text" id="reminderTitle" placeholder="Ej: Entrenar piernas">
    </div>
    <div class="form-group">
      <label>Hora</label>
      <input type="time" id="reminderTime">
    </div>
    <div class="form-group">
      <label>Tipo</label>
      <select id="reminderType">
        <option value="workout">Entrenamiento</option>
        <option value="hydration">Hidrataci√≥n</option>
        <option value="nutrition">Nutrici√≥n</option>
        <option value="rest">Descanso</option>
      </select>
    </div>
    <button class="btn" style="width:100%;" onclick="saveReminder()">Guardar Recordatorio</button>
  </div>
</div>

<!-- Modal: Exportar Datos -->
<div id="dataExportModal" class="modal">
  <div class="modal-content">
    <button class="modal-close" onclick="closeModal('dataExportModal')">‚úï</button>
    <div class="modal-title">üíæ Exportar Datos</div>
    <p style="color:rgba(255,255,255,0.8); margin-bottom:20px; font-size:13px;">Descarga tu informaci√≥n en el formato que prefieras:</p>
    <button class="btn" style="width:100%; margin-bottom:10px;" onclick="downloadAsJSON()">üìÑ Descargar JSON</button>
    <button class="btn secondary" style="width:100%;" onclick="downloadAsCSV()">üìä Descargar CSV</button>
  </div>
</div>

<script>
function renderDashboard() {
  // La autenticaci√≥n ya fue verificada en DOMContentLoaded
  // No verificar aqu√≠ de nuevo para evitar redirecciones infinitas
  
  try {
    renderStats();
    renderMotivation();
    updateStreak();
    renderStreak();
    renderIMCCalculator();
    renderRecentWorkouts();
    renderWeightRecords();
    renderAchievements();
    renderNotes();
    renderReminders();
  } catch (error) {
    console.error('Error renderizando dashboard:', error);
    showNotification('Error cargando dashboard', 'error');
  }
}

function renderStats() {
  const stats = getStatistics();
  const weights = getWeightStats();
  
  const html = `
    <div class="stat-card">
      <h3>Entrenamientos</h3>
      <div class="stat-value">${stats.completedWorkouts}/${stats.totalWorkouts}</div>
      <div class="stat-label">Completados esta semana: ${stats.workoutsThisWeek}</div>
    </div>
    <div class="stat-card">
      <h3>Logros</h3>
      <div class="stat-value">${stats.achievements}/${stats.allAchievements}</div>
      <div class="stat-label">Desbloqueados</div>
    </div>
    <div class="stat-card">
      <h3>Ejercicios Totales</h3>
      <div class="stat-value">${stats.totalExercises}</div>
      <div class="stat-label">Promedio: ${stats.averageExercisesPerWorkout} por sesi√≥n</div>
    </div>
    ${weights ? `
    <div class="stat-card">
      <h3>Peso Actual</h3>
      <div class="stat-value">${weights.current} kg</div>
      <div class="stat-label">Cambio: ${weights.change > 0 ? '+' : ''}${weights.change} kg</div>
    </div>
    ` : ''}
  `;
  
  document.getElementById('statsGrid').innerHTML = html;
}

function renderRecentWorkouts() {
  const workouts = getWorkouts().slice(-5).reverse();
  let html = '';
  
  if (workouts.length === 0) {
    html = '<p style="color:rgba(255,255,255,0.6);">No hay entrenamientos registrados</p>';
  } else {
    workouts.forEach(w => {
      const completed = w.completed ? 'completed' : '';
      const status = w.completed ? '‚úÖ' : '‚è≥';
      html += `
        <div class="workout-item ${completed}">
          <div class="workout-name">${status} ${w.name}</div>
          <div class="workout-exercises">${new Date(w.date).toLocaleDateString()}</div>
          <div class="exercise-list">
            ${w.exercises.map(e => `<div class="exercise-tag">${e.exerciseName}</div>`).join('')}
          </div>
          <div style="margin-top:10px; display:flex; gap:8px;">
            ${!w.completed ? `<button class="btn" style="padding:6px 12px; font-size:12px;" onclick="completeWorkout(${w.id})">Marcar Completado</button>` : ''}
            <button class="btn secondary" style="padding:6px 12px; font-size:12px;" onclick="deleteWorkout(${w.id})">Eliminar</button>
          </div>
        </div>
      `;
    });
  }
  
  document.getElementById('recentWorkouts').innerHTML = html;
}

function renderWeightRecords() {
  const records = getWeightRecords().slice(-10).reverse();
  let html = '';
  
  if (records.length === 0) {
    html = '<p style="color:rgba(255,255,255,0.6);">No hay registros de peso</p>';
  } else {
    html = records.map(r => `
      <div style="background:rgba(0,255,200,0.08); padding:12px; border-radius:6px; margin-bottom:10px; display:flex; justify-content:space-between; align-items:center;">
        <div>
          <div style="font-weight:600; color:#00ffc8;">${r.weight} kg</div>
          <div style="font-size:12px; color:rgba(255,255,255,0.6);">${new Date(r.date).toLocaleDateString()}</div>
          ${r.notes ? `<div style="font-size:11px; color:rgba(255,255,255,0.5); margin-top:4px;">${r.notes}</div>` : ''}
        </div>
        <button class="btn secondary" style="padding:6px 12px; font-size:12px;" onclick="deleteWeightRecord(${r.id})">Eliminar</button>
      </div>
    `).join('');
  }
  
  document.getElementById('weightRecordsDiv').innerHTML = html;
}

function renderAchievements() {
  const unlocked = getAchievements();
  const html = Object.entries(ACHIEVEMENTS).map(([id, ach]) => {
    const isUnlocked = unlocked.includes(id);
    return `
      <div class="achievement-badge" title="${ach.description}" style="${isUnlocked ? '' : 'opacity:0.3;'}">
        <div class="achievement-icon">${ach.name.split(' ')[0]}</div>
        <div class="achievement-name">${ach.name}</div>
      </div>
    `;
  }).join('');
  
  document.getElementById('achievementsGrid').innerHTML = html;
}

function renderNotes() {
  const notes = getNotes().reverse();
  let html = '';
  
  if (notes.length === 0) {
    html = '<p style="color:rgba(255,255,255,0.6);">No hay notas</p>';
  } else {
    html = notes.map(n => `
      <div class="note-item">
        <div class="note-info">
          <div class="note-title">${n.title}</div>
          <div class="note-content">${n.content.substring(0, 100)}${n.content.length > 100 ? '...' : ''}</div>
          <div class="note-date">${new Date(n.created).toLocaleDateString()}</div>
          <span class="note-type">${n.type}</span>
        </div>
        <button class="btn secondary" style="padding:6px 12px; font-size:12px;" onclick="deleteNote(${n.id}); renderNotes();">‚úï</button>
      </div>
    `).join('');
  }
  
  document.getElementById('notesDiv').innerHTML = html;
}

function renderReminders() {
  const reminders = getReminders();
  let html = '';
  
  if (reminders.length === 0) {
    html = '<p style="color:rgba(255,255,255,0.6);">No hay recordatorios</p>';
  } else {
    html = reminders.map(r => `
      <div style="background:rgba(0,255,200,0.08); padding:12px; border-radius:6px; margin-bottom:10px; display:flex; justify-content:space-between; align-items:center;">
        <div>
          <div style="font-weight:600; color:#00ffc8;">${r.title}</div>
          <div style="font-size:12px; color:rgba(255,255,255,0.6);">‚è∞ ${r.time} | ${r.type}</div>
        </div>
        <button class="btn secondary" style="padding:6px 12px; font-size:12px;" onclick="deleteReminder(${r.id}); renderReminders();">Eliminar</button>
      </div>
    `).join('');
  }
  
  document.getElementById('remindersDiv').innerHTML = html;
}

// Funciones de modales
function openModal(modalId) {
  document.getElementById(modalId).classList.add('active');
}

function closeModal(modalId) {
  document.getElementById(modalId).classList.remove('active');
}

function openWeightModal() { openModal('weightModal'); }
function openNoteModal() { openModal('noteModal'); }
function openReminderModal() { openModal('reminderModal'); }
function openDataExportModal() { openModal('dataExportModal'); }

// Guardar datos
function saveWeight() {
  const weight = document.getElementById('weightInput').value;
  const notes = document.getElementById('weightNotesInput').value;
  
  if (!weight) {
    showNotification('Ingresa tu peso', 'error');
    return;
  }
  
  addWeightRecord(weight, notes);
  closeModal('weightModal');
  document.getElementById('weightInput').value = '';
  document.getElementById('weightNotesInput').value = '';
  renderWeightRecords();
}

function saveNote() {
  const title = document.getElementById('noteTitle').value;
  const content = document.getElementById('noteContent').value;
  const type = document.getElementById('noteType').value;
  
  if (!title || !content) {
    showNotification('Completa t√≠tulo y contenido', 'error');
    return;
  }
  
  addNote(title, content, type);
  closeModal('noteModal');
  document.getElementById('noteTitle').value = '';
  document.getElementById('noteContent').value = '';
  renderNotes();
}

function saveReminder() {
  const title = document.getElementById('reminderTitle').value;
  const time = document.getElementById('reminderTime').value;
  const type = document.getElementById('reminderType').value;
  
  if (!title || !time) {
    showNotification('Completa t√≠tulo y hora', 'error');
    return;
  }
  
  setReminder(title, time, type);
  closeModal('reminderModal');
  document.getElementById('reminderTitle').value = '';
  document.getElementById('reminderTime').value = '';
  renderReminders();
}

function deleteWeightRecord(id) {
  const weights = getWeightRecords().filter(w => w.id !== id);
  localStorage.setItem(`weights_${currentUser.username}`, JSON.stringify(weights));
  renderWeightRecords();
  renderStats();
}

// Completar entrenamiento
function completeWorkout(workoutId) {
  completeWorkout(workoutId);
  renderRecentWorkouts();
  renderStats();
  renderDashboard();
}

// Inicializar
document.addEventListener('DOMContentLoaded', () => {
  // Primero inicializar autenticaci√≥n
  initAuth();
  
  setTimeout(() => {
    if (!isAuthenticated()) {
      location.href = 'index.html';
    } else {
      // Inicializar dashboard (achievements, theme, etc)
      initDashboard();
      // Renderizar el contenido
      renderDashboard();
    }
  }, 300);
});

// Cerrar modales al hacer click fuera
document.querySelectorAll('.modal').forEach(modal => {
  modal.addEventListener('click', (e) => {
    if (e.target === modal) {
      modal.classList.remove('active');
    }
  });
});
</script>

</body>
</html>
